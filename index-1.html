<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="zh_cn">
<head>
<meta charset="utf-8">
<meta name="description" content="description">
<meta name="viewport" content="width=device-width">
<title>博客 (旧文章页 1) | 博客</title>
<link href="assets/css/bitter.css" rel="stylesheet" type="text/css">
<link href="assets/css/main.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="#">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><style>
    div.input_prompt {
      display: none;
    }
    </style>
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
        <div class="post">
            <h1 class="title"><a href="posts/pycharmcao-zuo-zhi-nan.html">alt+`,6 显示版本历史</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-25T00:00:00+08:00">2016-01-25 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/pycharmcao-zuo-zhi-nan.html#disqus_thread" data-disqus-identifier="cache\posts\PyCharm操作指南.html">Comments</a>


                </div>
                
            </div>
            <div class="body">
                <div>
<h3>书签菜单 F11</h3>
<pre class="code literal-block">切换书签保存 ctrl+F11
显示书签 shift+F11
</pre>


<h3>收藏菜单 alt+shift+f alt+2</h3>
<pre class="code literal-block">ctrl+y ctrl+k
alt+insert 新建文件
ctrl+j 插入活动模版
ctrl+, 工具栏按钮
ctrl+m 滚动到中心
ctrl+e 最近打开文件


alt+`,6 显示版本历史
______
alt+↔ tab切换
ctrl+alt+↔ 分割切换
CTRL+P 参数信息
ctrl+O 继承父类方法重写
ctrl+I 实现方法
ctrl+F12 ctrl+t  文件结构
ctrl+alt+F12 文件路径
Alt+home 文件导航
Alt+鼠标上键 显示使用
#跳转到 [中键]
    ctrl+B     到声明
    ctrl+alt+B 到实现
    ctrl+shift+T 到测试


#层次结构 建议更换为 ctrl+r
    ctrl+H 类型层次结构
    ctrl+alt+H  call层次结构
    ctrl+shift+H 方法层次结构

ctrl+shift+space 显示参数信息, 内置可用↓
    ctrl+Q 快速文档 alt+左键
    ctrl+shift+i快速定义 alt+下


#代码
##提取
    ctrl+alt+v 到变量
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/pyautoguipywinauto.html">"\n",</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-25T00:00:00+08:00">2016-01-25 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/pyautoguipywinauto.html#disqus_thread" data-disqus-identifier="cache\posts\PyAutoGUI&amp;PyWinAuto.html">Comments</a>


                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PyAutoGUI&amp;PyWinAuto">PyAutoGUI&amp;PyWinAuto<a class="anchor-link" href="posts/pyautoguipywinauto.html#PyAutoGUI&amp;PyWinAuto">¶</a>
</h3>
<h3><img src="http://winsupersite.com/content/content/128528/win7/win7_ff_calc_rtm_02.jpg" alt=""></h3>
<p>這篇文章主要說明遇到 Windows native UI 時候或是Windows Application 時，如何進行自動化測試?</p>
<p>Selenium的自動化測試僅限於 Web UI，對於 Windows UI 或是 Windows 應用程式(例如小算盤)往往無法處理。</p>
<p>有什麼方式可以直接在 python 處理Windows UI 而不需要額外呼叫外部 AutoIT 所編譯的 EXE?</p>
<p>這篇文章介紹兩個方式，不儘 Windows 適用，Mac/Linux 也可以。最後給完整的程式範例說明。</p>
<h3 id="方法一：畫面圖形比對的方式-PyAutoGUI">方法一：畫面圖形比對的方式 PyAutoGUI<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E7%95%AB%E9%9D%A2%E5%9C%96%E5%BD%A2%E6%AF%94%E5%B0%8D%E7%9A%84%E6%96%B9%E5%BC%8F-PyAutoGUI">¶</a>
</h3>
<p>工具主角:PyAutoGUI</p>
<h4 id="安裝方式">安裝方式<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%AE%89%E8%A3%9D%E6%96%B9%E5%BC%8F">¶</a>
</h4>
<table><tbody><tr><td>pip    install   PyAutoGUI</td></tr></tbody></table>
<h4 id="優缺點">優缺點<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%84%AA%E7%BC%BA%E9%BB%9E">¶</a>
</h4>
<p>這個方式最大的好處是跨平台 Windows, Mac, Linux 都可以適用，因為採用圖形比對的關係也比較直覺。</p>
<p>缺點就是圖形比對來找畫面元件的操作方式，誤判或是失敗的機率會比較高。</p>
<p>另外，由於主要是用滑鼠作標的關係，因此螢幕解析度也有可能會影響程式的進行。</p>
<h4 id="實作範例">實作範例<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%AF%A6%E4%BD%9C%E7%AF%84%E4%BE%8B">¶</a>
</h4>
<p>我們主要用小算盤為例子。舉例來說，如果我們要點擊小算盤的 “7”。</p>
<p>我們可以截取一張圖如下，檔名為cal7.png。(檔案格式一定要是PNG)</p>
<p><img src="https://pyautogui.readthedocs.org/en/latest/_images/calc7key.png" alt="_images/calc7key.png"></p>
<p>執行下列 python 程式後，就會點擊到 7</p>

<pre><code>import pyautogui
#pyautogui.moveTo( pyautogui.size(),duration=2)

button7location = pyautogui.locateOnScreen('c:\\cal7.png')

pyautogui.click(button7location)</code></pre>
<p>要注意的是如果執行時小算盤被其他畫面遮到，那麼執行就會失敗。</p>
<p>因此，執行這類的程式時，必須要確保小算盤在螢幕上可以被看見。沒有被其他 Window 遮住。</p>
<h4 id="技術參考資料">技術參考資料<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E6%8A%80%E8%A1%93%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99">¶</a>
</h4>
<p><a href="https://pypi.python.org/pypi/PyAutoGUI">https://pypi.python.org/pypi/PyAutoGUI</a></p>
<p><a href="https://pyautogui.readthedocs.org/en/latest/index.html">https://pyautogui.readthedocs.org/en/latest/index.html</a></p>
<h3 id="分法二:-Windows-ObjectID-的方式-PyWinAuto-+-SWAPY">分法二: Windows ObjectID 的方式 PyWinAuto + SWAPY<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%88%86%E6%B3%95%E4%BA%8C:-Windows-ObjectID-%E7%9A%84%E6%96%B9%E5%BC%8F-PyWinAuto-+-SWAPY">¶</a>
</h3>
<p>工具主角: PyWinAuto + SWAPY</p>
<h4 id="安裝方式">安裝方式<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%AE%89%E8%A3%9D%E6%96%B9%E5%BC%8F">¶</a>
</h4>
<p>1. 首先安裝 PyWinAuto</p>
<table style="height: 32px;" width="250"><tbody><tr><td>pip   install    pyWinAuto</td></tr></tbody></table>
<p>2. 下載 SWAPY (<a href="https://code.google.com/p/swapy/">Simple Windows Automation on Python</a>)</p>
<p>SWAPY 為一個獨立的執行工具 ，可以在這裡下載安裝：</p>
<p><a href="https://swapy.googlecode.com/files/swapy-ob-0.4.3.exe">https://swapy.googlecode.com/files/swapy-ob-0.4.3.exe</a></p>
<h4 id="優缺點">優缺點<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%84%AA%E7%BC%BA%E9%BB%9E">¶</a>
</h4>
<p>PyWinAuto 這個方式主要透過 Windows Object locator 來定位 Windows 元件。</p>
<p>缺點是只能限定在 Windows 平台使用。</p>
<p>優點是透過 ObjectID 的方式定位，比較不會像圖形比對那樣失敗或是受到畫面修改的影響。</p>
<p>另外一個最大的優點是，我們可以透過 “SWAPY”這個工具自動產生程式!</p>
<h3 id="測試情境">測試情境<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E6%B8%AC%E8%A9%A6%E6%83%85%E5%A2%83">¶</a>
</h3>
<p>我們主要會自動執行下列動作：</p>
<p>1. 啟動 notepad</p>
<p>2. 用電腦自動點選 Help &gt; About Notepad</p>
<h3 id="為什麼用-SWAPY實作">為什麼用 SWAPY實作<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E7%82%BA%E4%BB%80%E9%BA%BC%E7%94%A8-SWAPY%E5%AF%A6%E4%BD%9C">¶</a>
</h3>
<p>雖然我們可以直接寫 PyWinAuto 的程式，但是筆者還是建議用 SWAPY 這個工具來直接產生。因為這個工具 SWAPY 就好比是瀏覽器的  Web element inspector ，可以看 Windows 物件的狀況，幫助我們定位並且做適當的動作 (click..)</p>
<p>1. 首先先啟動 notepad.exe</p>
<p>2. 接著再啟動 SWAPY。</p>
<p>因為 SWAPY 沒有 refresh 的功能，所以如果先啟動 SWAPY 之後再啟動 notepad的話，SWAPY 會找不到 notepad.exe</p>
<p>如果開啟的視窗比較多的話，一開始啟動的時間會比較久一些。</p>
<h3 id="SWAPY-實作使用步驟">SWAPY 實作使用步驟<a class="anchor-link" href="posts/pyautoguipywinauto.html#SWAPY-%E5%AF%A6%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%A9%9F">¶</a>
</h3>
<p>1. 啟動SWAPY之後，找到 “Untitled – Notepad” &gt; 右鍵 &gt; “Set Focus”</p>
<p>2. 展開 menu &gt; &amp;About Notepad &gt;  右鍵 &gt; “(click” 如下圖所示)</p>
<p>3. SWAPY 就會自動完成，右手邊 Editor 的相關 python 程式! 是不是很方便。</p>
<p>[<img src="posts/images/SWAPY-use1.png" alt="SWAPY use1"></p>
<p>由於notepad.exe 是我們手動所啟動，所以要將該 python 程式自動化執行，每次都會自動啟動 notepad</p>
<p>所以上述自動產生程式最上面再加入這行：</p>
<table><tbody><tr><td>pwa_app.start_(‘notepad.exe’)</td></tr></tbody></table>
<h3 id="完整Python程式碼範例-(SWAPY自動產生)">完整Python程式碼範例 (SWAPY自動產生)<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E5%AE%8C%E6%95%B4Python%E7%A8%8B%E5%BC%8F%E7%A2%BC%E7%AF%84%E4%BE%8B-(SWAPY%E8%87%AA%E5%8B%95%E7%94%A2%E7%94%9F)">¶</a>
</h3>
<pre><code>import pywinauto


pwa_app = pywinauto.application.Application()

# Add this line to launch notepad.exe. The other parts of source code were generated by SWAPY
pwa_app.start_('notepad.exe')

w_handle = pywinauto.findwindows.find_windows(title=u'Untitled - Notepad', class_name='Notepad')[0]
window = pwa_app.window_(handle=w_handle)
window.SetFocus()
window.MenuItem(u'&amp;Help-&gt;&amp;About Notepad').Click()</code></pre>
<p><a href="http://pywinauto.github.io/docs/">http://pywinauto.github.io/docs/</a></p>
<p><a href="https://github.com/pywinauto/pywinauto">https://github.com/pywinauto/pywinauto</a></p>
<p><a href="https://github.com/pywinauto/pywinauto/tree/f0e892cce6f367d94b675bb1b9e5db20f0425747/examples">https://github.com/pywinauto/pywinauto/tree/f0e892cce6f367d94b675bb1b9e5db20f0425747/examples</a></p>
<h3 id="AutoIT">AutoIT<a class="anchor-link" href="posts/pyautoguipywinauto.html#AutoIT">¶</a>
</h3>
<p>另外可以使用AutoIT，將自動化程式編譯成EXE</p>
<p><a href="https://www.autoitscript.com/site/autoit/">https://www.autoitscript.com/site/autoit/</a></p>
<h3 id="PyAutoGUI與PyWinAuto比較">PyAutoGUI與PyWinAuto比較<a class="anchor-link" href="posts/pyautoguipywinauto.html#PyAutoGUI%E8%88%87PyWinAuto%E6%AF%94%E8%BC%83">¶</a>
</h3>
<table style="height: 307px;" width="833"><tbody>
<tr>
<td>工具</td>
<td>**PyAutoGUI**</td>
<td>**PyWinAuto + SWAPY**</td>
</tr>
<tr>
<td>定位方式</td>
<td>透過圖形PNG</td>
<td> Windows objectID</td>
</tr>
<tr>
<td>實作</td>
<td>必須要透過截圖程式抓取要點選的畫面</td>
<td>使用SWAPY工具</td>
</tr>
<tr>
<td>程式失敗的可能原因</td>
<td>圖形比對失敗螢幕解析度該畫面被其他視窗遮蓋</td>
<td>相對穩定</td>
</tr>
<tr>
<td>適用平台</td>
<td>Mac, Linux, Windows</td>
<td>Windows Only</td>
</tr>
<tr>
<td>適用應用程式</td>
<td>因為是圖形比對的方式，所以網頁、Java Applet、Flash、Windows UI、Mac UI等都可以適用</td>
<td>Windows Application only</td>
</tr>
</tbody></table>
<h3 id="pyWinAuto範例程式">pyWinAuto範例程式<a class="anchor-link" href="posts/pyautoguipywinauto.html#pyWinAuto%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F">¶</a>
</h3>
<p><a href="https://github.com/pywinauto/pywinauto/tree/298bb017f91f30cc524988bfa582ee46d7aed775/examples">https://github.com/pywinauto/pywinauto/tree/298bb017f91f30cc524988bfa582ee46d7aed775/examples</a></p>
<h3 id="来源--(http://www.qa-knowhow.com/?p=2559)">来源  (<a href="http://www.qa-knowhow.com/?p=2559">http://www.qa-knowhow.com/?p=2559</a>)<a class="anchor-link" href="posts/pyautoguipywinauto.html#%E6%9D%A5%E6%BA%90--(http://www.qa-knowhow.com/?p=2559)">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>

            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/doing.html">Doing</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-25T00:00:00+08:00">2016-01-25 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/doing.html#disqus_thread" data-disqus-identifier="cache\posts\Doing.html">Comments</a>


                </div>
                
            </div>
            <div class="body">
                <span></span>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/cmdmarkdownzai-xian-bian-ji-qi.html">"\n",</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-25T00:00:00+08:00">2016-01-25 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#disqus_thread" data-disqus-identifier="cache\posts\CmdMarkdown在线编辑器.html">Comments</a>


                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="欢迎使用-Cmd-Markdown-编辑阅读器">欢迎使用 Cmd Markdown 编辑阅读器<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#%E6%AC%A2%E8%BF%8E%E4%BD%BF%E7%94%A8-Cmd-Markdown-%E7%BC%96%E8%BE%91%E9%98%85%E8%AF%BB%E5%99%A8">¶</a>
</h2>
<hr>
<p>我们理解您需要更便捷更高效的工具记录思想，整理笔记、知识，并将其中承载的价值传播给他人，<strong>Cmd Markdown</strong> 是我们给出的答案 —— 我们为记录思想和分享知识提供更专业的工具。 您可以使用 Cmd Markdown：</p>
<blockquote><ul>
<li>整理知识，学习笔记</li>
<li>发布日记，杂文，所见所想</li>
<li>撰写发布技术文稿（代码支持）</li>
<li>撰写发布学术论文（LaTeX 公式支持）</li>
</ul></blockquote>
<p><img src="https://www.zybuluo.com/static/img/logo.png" alt="cmd-markdown-logo"></p>
<p>除了您现在看到的这个 Cmd Markdown 在线版本，您还可以前往以下网址下载：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Windows/Mac/Linux-全平台客户端">
<a href="https://www.zybuluo.com/cmd/">Windows/Mac/Linux 全平台客户端</a><a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#Windows/Mac/Linux-%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%AE%A2%E6%88%B7%E7%AB%AF">¶</a>
</h4>
<blockquote>
<p>请保留此份 Cmd Markdown 的欢迎稿兼使用说明，如需撰写新稿件，点击顶部工具栏右侧的 <i class="icon-file"></i> <strong>新文稿</strong> 或者使用快捷键 <code>Ctrl+Alt+N</code>。</p>
</blockquote>
<hr>
<h3 id="什么是-Markdown">什么是 Markdown<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#%E4%BB%80%E4%B9%88%E6%98%AF-Markdown">¶</a>
</h3>
<p>Markdown 是一种方便记忆、书写的纯文本标记语言，用户可以使用这些标记符号以最小的输入代价生成极富表现力的文档：譬如您正在阅读的这份文档。它使用简单的符号标记不同的标题，分割不同的段落，<strong>粗体</strong> 或者 <em>斜体</em> 某些文字，更棒的是，它还可以</p>
<h4 id="1.-制作一份待办事宜-Todo-列表">1. 制作一份待办事宜 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#13-%E5%BE%85%E5%8A%9E%E4%BA%8B%E5%AE%9C-todo-%E5%88%97%E8%A1%A8">Todo 列表</a><a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#1.-%E5%88%B6%E4%BD%9C%E4%B8%80%E4%BB%BD%E5%BE%85%E5%8A%9E%E4%BA%8B%E5%AE%9C-Todo-%E5%88%97%E8%A1%A8">¶</a>
</h4>
<ul>
<li>[ ] 支持以 PDF 格式导出文稿</li>
<li>[ ] 改进 Cmd 渲染算法，使用局部渲染技术提高渲染效率</li>
<li>[x] 新增 Todo 列表功能</li>
<li>[x] 修复 LaTex 公式渲染问题</li>
<li>[x] 新增 LaTex 公式编号功能</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.-书写一个质能守恒公式[^LaTeX]">2. 书写一个质能守恒公式[^LaTeX]<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#2.-%E4%B9%A6%E5%86%99%E4%B8%80%E4%B8%AA%E8%B4%A8%E8%83%BD%E5%AE%88%E6%81%92%E5%85%AC%E5%BC%8F%5B%5ELaTeX%5D">¶</a>
</h4>$$E=mc^2$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.-高亮一段代码[^code]">3. 高亮一段代码[^code]<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#3.-%E9%AB%98%E4%BA%AE%E4%B8%80%E6%AE%B5%E4%BB%A3%E7%A0%81%5B%5Ecode%5D">¶</a>
</h4>
<div class="highlight"><pre><span class="nd">@requires_authorization</span>
<span class="k">class</span> <span class="nc">SomeClass</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="c"># A comment</span>
    <span class="k">print</span> <span class="s">'hello world'</span>
</pre></div>
<h4 id="6.-绘制表格">6. 绘制表格<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#6.-%E7%BB%98%E5%88%B6%E8%A1%A8%E6%A0%BC">¶</a>
</h4>
<table>
<thead><tr>
<th>项目</th>
<th style="text-align:right">价格</th>
<th style="text-align:center">数量</th>
</tr></thead>
<tbody>
<tr>
<td>计算机</td>
<td style="text-align:right">\$1600</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td>手机</td>
<td style="text-align:right">\$12</td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td>管线</td>
<td style="text-align:right">\$1</td>
<td style="text-align:center">234</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="7.-更详细语法说明">7. 更详细语法说明<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#7.-%E6%9B%B4%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E8%AF%B4%E6%98%8E">¶</a>
</h4>
<p>想要查看更详细的语法说明，可以参考我们准备的 [Cmd Markdown 简明语法手册][1]，进阶用户可以参考 [Cmd Markdown 高阶语法手册][2] 了解更多高级功能。</p>
<p>总而言之，不同于其它 <em>所见即所得</em> 的编辑器：你只需使用键盘专注于书写文本内容，就可以生成印刷级的排版格式，省却在键盘和工具栏之间来回切换，调整内容和格式的麻烦。<strong>Markdown 在流畅的书写和印刷级的阅读体验之间找到了平衡。</strong> 目前它已经成为世界上最大的技术分享网站 GitHub 和 技术问答网站 StackOverFlow 的御用书写格式。</p>
<hr>
<h3 id="什么是-Cmd-Markdown">什么是 Cmd Markdown<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#%E4%BB%80%E4%B9%88%E6%98%AF-Cmd-Markdown">¶</a>
</h3>
<p>您可以使用很多工具书写 Markdown，但是 Cmd Markdown 是这个星球上我们已知的、最好的 Markdown 工具——没有之一 ：）因为深信文字的力量，所以我们和你一样，对流畅书写，分享思想和知识，以及阅读体验有极致的追求，我们把对于这些诉求的回应整合在 Cmd Markdown，并且一次，两次，三次，乃至无数次地提升这个工具的体验，最终将它演化成一个 <strong>编辑/发布/阅读</strong> Markdown 的在线平台——您可以在任何地方，任何系统/设备上管理这里的文字。</p>
<h4 id="1.-实时同步预览">1. 实时同步预览<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#1.-%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E9%A2%84%E8%A7%88">¶</a>
</h4>
<p>我们将 Cmd Markdown 的主界面一分为二，左边为<strong>编辑区</strong>，右边为<strong>预览区</strong>，在编辑区的操作会实时地渲染到预览区方便查看最终的版面效果，并且如果你在其中一个区拖动滚动条，我们有一个巧妙的算法把另一个区的滚动条同步到等价的位置，超酷！</p>
<h4 id="2.-编辑工具栏">2. 编辑工具栏<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#2.-%E7%BC%96%E8%BE%91%E5%B7%A5%E5%85%B7%E6%A0%8F">¶</a>
</h4>
<p>也许您还是一个 Markdown 语法的新手，在您完全熟悉它之前，我们在 <strong>编辑区</strong> 的顶部放置了一个如下图所示的工具栏，您可以使用鼠标在工具栏上调整格式，不过我们仍旧鼓励你使用键盘标记格式，提高书写的流畅度。</p>
<p><img src="https://www.zybuluo.com/static/img/toolbar-editor.png" alt="tool-editor"></p>
<h4 id="3.-编辑模式">3. 编辑模式<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#3.-%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F">¶</a>
</h4>
<p>完全心无旁骛的方式编辑文字：点击 <strong>编辑工具栏</strong> 最右测的拉伸按钮或者按下 <code>Ctrl + M</code>，将 Cmd Markdown 切换到独立的编辑模式，这是一个极度简洁的写作环境，所有可能会引起分心的元素都已经被挪除，超清爽！</p>
<h4 id="4.-实时的云端文稿">4. 实时的云端文稿<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#4.-%E5%AE%9E%E6%97%B6%E7%9A%84%E4%BA%91%E7%AB%AF%E6%96%87%E7%A8%BF">¶</a>
</h4>
<p>为了保障数据安全，Cmd Markdown 会将您每一次击键的内容保存至云端，同时在 <strong>编辑工具栏</strong> 的最右侧提示 <code>已保存</code> 的字样。无需担心浏览器崩溃，机器掉电或者地震，海啸——在编辑的过程中随时关闭浏览器或者机器，下一次回到 Cmd Markdown 的时候继续写作。</p>
<h4 id="5.-离线模式">5. 离线模式<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#5.-%E7%A6%BB%E7%BA%BF%E6%A8%A1%E5%BC%8F">¶</a>
</h4>
<p>在网络环境不稳定的情况下记录文字一样很安全！在您写作的时候，如果电脑突然失去网络连接，Cmd Markdown 会智能切换至离线模式，将您后续键入的文字保存在本地，直到网络恢复再将他们传送至云端，即使在网络恢复前关闭浏览器或者电脑，一样没有问题，等到下次开启 Cmd Markdown 的时候，她会提醒您将离线保存的文字传送至云端。简而言之，我们尽最大的努力保障您文字的安全。</p>
<h4 id="6.-管理工具栏">6. 管理工具栏<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#6.-%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E6%A0%8F">¶</a>
</h4>
<p>为了便于管理您的文稿，在 <strong>预览区</strong> 的顶部放置了如下所示的 <strong>管理工具栏</strong>：</p>
<p><img src="https://www.zybuluo.com/static/img/toolbar-manager.jpg" alt="tool-manager"></p>
<p>通过管理工具栏可以：</p>
<p><i class="icon-share"></i> 发布：将当前的文稿生成固定链接，在网络上发布，分享
<i class="icon-file"></i> 新建：开始撰写一篇新的文稿
<i class="icon-trash"></i> 删除：删除当前的文稿
<i class="icon-cloud"></i> 导出：将当前的文稿转化为 Markdown 文本或者 Html 格式，并导出到本地
<i class="icon-reorder"></i> 列表：所有新增和过往的文稿都可以在这里查看、操作
<i class="icon-pencil"></i> 模式：切换 普通/Vim/Emacs 编辑模式</p>
<h4 id="7.-阅读工具栏">7. 阅读工具栏<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#7.-%E9%98%85%E8%AF%BB%E5%B7%A5%E5%85%B7%E6%A0%8F">¶</a>
</h4>
<p><img src="https://www.zybuluo.com/static/img/toolbar-reader.jpg" alt="tool-manager"></p>
<p>通过 <strong>预览区</strong> 右上角的 <strong>阅读工具栏</strong>，可以查看当前文稿的目录并增强阅读体验。</p>
<p>工具栏上的五个图标依次为：</p>
<p><i class="icon-list"></i> 目录：快速导航当前文稿的目录结构以跳转到感兴趣的段落
<i class="icon-chevron-sign-left"></i> 视图：互换左边编辑区和右边预览区的位置
<i class="icon-adjust"></i> 主题：内置了黑白两种模式的主题，试试 <strong>黑色主题</strong>，超炫！
<i class="icon-desktop"></i> 阅读：心无旁骛的阅读模式提供超一流的阅读体验
<i class="icon-fullscreen"></i> 全屏：简洁，简洁，再简洁，一个完全沉浸式的写作和阅读环境</p>
<h4 id="8.-阅读模式">8. 阅读模式<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#8.-%E9%98%85%E8%AF%BB%E6%A8%A1%E5%BC%8F">¶</a>
</h4>
<p>在 <strong>阅读工具栏</strong> 点击 <i class="icon-desktop"></i> 或者按下 <code>Ctrl+Alt+M</code> 随即进入独立的阅读模式界面，我们在版面渲染上的每一个细节：字体，字号，行间距，前背景色都倾注了大量的时间，努力提升阅读的体验和品质。</p>
<h4 id="9.-标签、分类和搜索">9. 标签、分类和搜索<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#9.-%E6%A0%87%E7%AD%BE%E3%80%81%E5%88%86%E7%B1%BB%E5%92%8C%E6%90%9C%E7%B4%A2">¶</a>
</h4>
<p>在编辑区任意行首位置输入以下格式的文字可以标签当前文档：</p>
<p>标签： 未分类</p>
<p>标签以后的文稿在【文件列表】（Ctrl+Alt+F）里会按照标签分类，用户可以同时使用键盘或者鼠标浏览查看，或者在【文件列表】的搜索文本框内搜索标题关键字过滤文稿，如下图所示：</p>
<p><img src="https://www.zybuluo.com/static/img/file-list.png" alt="file-list"></p>
<h4 id="10.-文稿发布和分享">10. 文稿发布和分享<a class="anchor-link" href="posts/cmdmarkdownzai-xian-bian-ji-qi.html#10.-%E6%96%87%E7%A8%BF%E5%8F%91%E5%B8%83%E5%92%8C%E5%88%86%E4%BA%AB">¶</a>
</h4>
<p>在您使用 Cmd Markdown 记录，创作，整理，阅读文稿的同时，我们不仅希望它是一个有力的工具，更希望您的思想和知识通过这个平台，连同优质的阅读体验，将他们分享给有相同志趣的人，进而鼓励更多的人来到这里记录分享他们的思想和知识，尝试点击 <i class="icon-share"></i> (Ctrl+Alt+P) 发布这份文档给好友吧！</p>
<hr>
<p>再一次感谢您花费时间阅读这份欢迎稿，点击 <i class="icon-file"></i> (Ctrl+Alt+N) 开始撰写新的文稿吧！祝您在这里记录、阅读、分享愉快！</p>
<p>作者 [@ghosert][3]<br>
2015 年 06月 15日</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="footnotes">
<hr>
<ol></ol>
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>

            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/0101-python-overview.html">"source": [</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-01-25T00:00:00+08:00">2016-01-25 00:00</time>
</div>
                <div class="stats">
                                <a href="posts/0101-python-overview.html#disqus_thread" data-disqus-identifier="cache\posts\01.01 python overview.html">Comments</a>


                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python简介">Python简介<a class="anchor-link" href="posts/0101-python-overview.html#Python%E7%AE%80%E4%BB%8B">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Python历史">
<strong>Python</strong>历史<a class="anchor-link" href="posts/0101-python-overview.html#Python%E5%8E%86%E5%8F%B2">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python的创始人为荷兰人吉多·范罗苏姆（Guido van Rossum）。1989年的圣诞节期间，吉多·范罗苏姆为了在阿姆斯特丹打发时间，决心开发一个新的脚本解释程序，作为ABC语言的一种继承。之所以选中Python作为程序的名字，是因为他是BBC电视剧——蒙提·派森的飞行马戏团（Monty Python's Flying Circus）的爱好者。</p>
<p>1991年，第一个Python编译器诞生。它是用C语言实现的，并能够调用C语言的库文件。</p>
<p>Python 2.0于2000年10月16日发布，增加了实现完整的垃圾回收，并且支持Unicode。</p>
<p>Python 3.0于2008年12月3日发布，此版不完全兼容之前的Python源代码。不过，很多新特性后来也被移植到旧的Python 2.6/2.7版本。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="第一行Python代码">第一行Python代码<a class="anchor-link" href="posts/0101-python-overview.html#%E7%AC%AC%E4%B8%80%E8%A1%8CPython%E4%BB%A3%E7%A0%81">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>安装好Python之后，在命令行下输入：</p>

<pre><code>python

</code></pre>
<p>就可以进入Python解释器的页面。</p>
<p>按照惯例，第一行代码应该是输出 <code>"hello world!"</code>：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span> <span class="s">"hello world!"</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>相对<strong>Java</strong>，<strong>C</strong>等语言来说，<strong>Python</strong>仅仅使用一行语句就完成的了这个任务。</p>
<p>可以将这句话的内容保存到一个文本文件中，并使用后缀名 <code>.py</code> 结尾，例如 <code>hello_world.py</code>，在命令行下运行这个程序：</p>

<pre><code>python hello_world.py

</code></pre>
<p>也会输出 <code>"hello world!"</code> 的结果。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Python之禅">Python之禅<a class="anchor-link" href="posts/0101-python-overview.html#Python%E4%B9%8B%E7%A6%85">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在<strong>Python</strong>解释器下输入 <code>import this</code>，会出来这样一首小诗：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">this</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这首诗反映了<strong>Python</strong>的设计哲学——<strong>Python</strong>是一种追求优雅，明确，简单的编程语言，但事实上，产生这首诗的代码并没有写的那么简单易懂：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">s</span> <span class="o">=</span> <span class="s">"""Gur Mra bs Clguba, ol Gvz Crgref</span>

<span class="s">Ornhgvshy vf orggre guna htyl.</span>
<span class="s">Rkcyvpvg vf orggre guna vzcyvpvg.</span>
<span class="s">Fvzcyr vf orggre guna pbzcyrk.</span>
<span class="s">Pbzcyrk vf orggre guna pbzcyvpngrq.</span>
<span class="s">Syng vf orggre guna arfgrq.</span>
<span class="s">Fcnefr vf orggre guna qrafr.</span>
<span class="s">Ernqnovyvgl pbhagf.</span>
<span class="s">Fcrpvny pnfrf nera'g fcrpvny rabhtu gb oernx gur ehyrf.</span>
<span class="s">Nygubhtu cenpgvpnyvgl orngf chevgl.</span>
<span class="s">Reebef fubhyq arire cnff fvyragyl.</span>
<span class="s">Hayrff rkcyvpvgyl fvyraprq.</span>
<span class="s">Va gur snpr bs nzovthvgl, ershfr gur grzcgngvba gb thrff.</span>
<span class="s">Gurer fubhyq or bar-- naq cersrenoyl bayl bar --boivbhf jnl gb qb vg.</span>
<span class="s">Nygubhtu gung jnl znl abg or boivbhf ng svefg hayrff lbh'er Qhgpu.</span>
<span class="s">Abj vf orggre guna arire.</span>
<span class="s">Nygubhtu arire vf bsgra orggre guna *evtug* abj.</span>
<span class="s">Vs gur vzcyrzragngvba vf uneq gb rkcynva, vg'f n onq vqrn.</span>
<span class="s">Vs gur vzcyrzragngvba vf rnfl gb rkcynva, vg znl or n tbbq vqrn.</span>
<span class="s">Anzrfcnprf ner bar ubaxvat terng vqrn -- yrg'f qb zber bs gubfr!"""</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">97</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>

<span class="k">print</span> <span class="s">""</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>Life is short. Use Python.</p>
</blockquote>

</div>
</div>
</div>
    </div>
  </div>

            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/nikola-web.html">Nikola: 静态博客A.K.A引擎，我是怎样创建Shisaa.jp</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-01T18:52:05+08:00">2013-08-01 18:52</time>
</div>
                <div class="stats">
                                <a href="posts/nikola-web.html#disqus_thread" data-disqus-identifier="cache\posts\nikola-web.html">Comments</a>


                </div>
                        <div itemprop="keywords" class="tags">
        <ul>
        标签 : 
           <li><a class="tag p-category" href="categories/nikola.html" rel="tag">nikola</a></li>
           <li><a class="tag p-category" href="categories/python.html" rel="tag">python</a></li>
           <li><a class="tag p-category" href="categories/web.html" rel="tag">web</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<h3>写在前面的话</h3>
<p>当我在Google搜索用git做博客的时候我看到github提供了免费静态页面服务，而且提供Jekyll工具，允许用户用轻量级标记语言（比如Markdown）来写文章，然后生成博客页面。同类的工具还有Octopress。但用的是Ruby语言，在windows下安装环境特别麻烦。因我比较喜欢用Python，再继续搜索，看到了Pelican，只支持Python2.7以上版本，把本地的Python版本更新到2.7版本，好不容易安装好了Pelican环境，但发现Pelican用Makefile来管理项目，而Makefile在Windows下就是一个恶梦。最后看到了Nikola，按照官方文档很快就上手了，而且默认的样式还是特好看的，所以就最终选择了Nikola来建立静态博客。</p>
<p>在Nikola的有一篇文章<a href="http://shisaa.jp/postset/nikola-web.html" title="Goes from installing to developing a custom theme.">Tutorial by Tim van der Linden</a>，正好解决了我对Nikola的一些问题，为了日后查阅方便，也为了能让更多母语是中文的网络爱好者认识Nikola，故翻译了这篇文章。</p>
<hr>
<h3>前言</h3>
<p>首先，非常感谢Nikola创作者Roberto Alsina，给这篇文章<a href="http://getnikola.com/blog/new-nikola-tutorial.html" title="基于Nikola建立博客shisaa.jp">很高的评价</a>，并将其嵌入到Nikola文档中！</p>
<p>当我设计Shisaa.jp的时候我花一些时间思考用怎么样的“后端”。什么样的系统建站...使用CMS吗？
我使用Drupal有丰富的经验，这可能是我的首选......但熟悉Drupal的，也知道一些难以忽视的事实：</p>
<ul>
<li>Drupal是用PHP编写的，这不是我所向往的编程语言。</li>
<li>Drupal有很强大的工具，但运行会慢得像蜗牛，这是一个典型的多用途CMS的负担，几乎这样的框架系统都是这样。</li>
<li>Drupal 8即将推出，这是一个全新和充满亮点的版本，是建立另一框架之上（symfony），所以它是框架之上的框架...在正常的情况下，意味着它将变得更慢。</li>
</ul>
<p>因此，不用Drupal，那用什么呢？Wordpress, Joomla...？这...永远...不可能，它们都是用PHP做后端的语言。</p>
<p>好，不用PHP驱动系统...我更喜欢用Python，所以可能是Plone, Pylons, Pyramid, ...？</p>
<p>可能……</p>
<!-- TEASER_END -->

<p>但仍有一个挥之不去的声音在我的后脑环绕......“我真的需要一个CMS”？</p>
<p>我的意思是，你想想，我只这个网站的唯一作者，不需要其它的用户登录来更新内容，也不需要花哨的界面。
还有安全问题......每一个动态系统在互联网上很容易受各种可怕的攻击......因为他们是动态的。
哦，还有性能问题，访问一些普通的HTML文件绝对比动态拼凑一个页面请求（即使缓存）要快很多倍。</p>
<p>所以我决定建立这个网站用<strong>静态</strong>方式，为什么呢？</p>
<p>当你决定建立自己的静态网站，基本上你有两种选择：</p>
<ol>
<li>手工方式写每个HTML文档</li>
<li>使用一种静态页面生成器</li>
</ol>
<p>如果选择方案一，你必须要花大量的工作在自己的网站上。如果你的网站或博客只包含几页而且只每年更新两次，那这古老​​的手工制作的网页是可行的。但是，如果你需要频繁地更新网站，从头写每一页并且保持所有的菜单和深层链接将成为地狱的工作......这会使你失去所有建立个人网站的乐趣。</p>
<p>这就需要静态页面生成器来帮助你。一旦安装了它，它就会为你做繁重的工作，因此您可以集中精力写你的博客，维护公司的网站，在线更新图片最新事件等..</p>
<p>你会问：“但我将需要大量的技术知识，如果我使用这些类型的系统的话”。不，你不会的。
这些系统只需要很少的一些配置就可以了（但系统本身可不是，为什么？），良好的工具可以让你有条不紊地进行工作！</p>
<h3>关于Nikola</h3>
<p>事实上我对Nikola Tesla有极大的兴趣，我很快就感觉到<a href="http://getnikola.com/" title="Nikola主页">这点</a>，Nikola将是我的首选武器，它是相当快速和优雅的系统，具有不错的功能集合，而且可扩展。它还包含了一个实用的工具包来帮助你建立或创作你的网站。它甚至是多语言的！</p>
<p>去阅读<a href="http://getnikola.com/handbook.html" title="Nikola手册">Roberto Alsina的</a>Nikola手册关于这个项目背后的动机和美丽的功能并提供的工具。在该网站上，你还会发现有相当详细的指南教你如何开始建立自己的网站。尽管Roberto尽最大努力来指导你使用Nikola，但我觉得还有有点抽象，尤其在主题化上，只好自己去探索。</p>
<p>所以我现在带你进行短暂的旅行，告诉你我是如何用Nikola设置，部署和制作这个网站，基于上述原因，主要是基本设置和建立您的自定义主题。</p>
<h3>环境设置</h3>
<p>在进入主题之前，我们必须先配置Nikola......当然配置Nikola，我们必须配置我们的Python环境。
由于许多程序在您的Unix系统上安装了各种版本的Python，有时很难设置一个干净的可以运行你项目的工作空间。
你需要一个基于特定Python版本的沙箱开发环境。对于这个沙箱环境，我使用流行的<a href="http://www.virtualenv.org/" title="Virtualenv工程首页">Virtualenv</a>。</p>
<p>使用Virtualenv你能做到以上所有要求...在你选择的目录下部署一个新的虚拟环境，并把Shell指向那个目录，你就可以开始建网站了。首先来安装Virtualenv：</p>
<pre class="code literal-block"><span class="nv">$ </span>pip install virtualenv
</pre>


<p>现在，我们可以设置我们的虚拟环境</p>
<pre class="code literal-block"><span class="nv">$ </span>virtualenv --python<span class="o">=</span>python2.7 yourdir
</pre>


<p>注意：我告诉Virtualenv使用Python2.7版本，Nikola 5.3 <em>是</em> 兼容Python 3的，但如果你想提供一个很好的谷歌地图XML，你只有采用Python2.x版本。
完成了Virtualenv沙箱的设置，<strong>进到该目录</strong>加载该沙箱环境到当前的Shell：</p>
<pre class="code literal-block"><span class="nv">$ </span><span class="nb">source </span>bin/activate
</pre>


<p>瞧，你会发现在当前目录名插入到你使用的Shell前面，这意味着一切都很好。现在...来安装Nikola！</p>
<pre class="code literal-block"><span class="nv">$ </span>pip install nikola
</pre>


<p>这将会安装的是Nikola5.3（在当时写这的时候），并为您安装所有必要的依赖。现在，我们开始初始化我们的网站。</p>
<h3>初步建立</h3>
<p>要建立一个新的站点，你只要简单地运行：</p>
<pre class="code literal-block"><span class="nv">$ </span>nikola init shisaa.jp
</pre>


<p>自从Nikola 5.2 将创建一个 <em>空</em> 的网站，只包含基本的目录结构和配置文件的示例。
你可以编译这个网站，它将工作在这个沙箱外面。 5.2之前的init命令将生成一个空的网站并填充示范数据。
如果您还想这种行为只需要附加"--demo"标示在init命令后面。</p>
<p>进入你建立的目录，你会发现创建的网站目录结构如下：</p>
<pre class="code literal-block">files
galleries
listings
posts
stories
</pre>


<p>让我们快速看一下每个目录的作用（和Nikola的一些特性）：</p>
<p><em>files</em> 目录包含静态资源，无论你使用什么主题它都是有效的。
<em>Galleries</em> Nikola展示照片画廊功能。在这个目录里，只要你喜欢，你可以创建尽可能多的目录，每一个目录都是单独的画廊。
接下来是 <em>listings</em> ，这个目录将包含源代码列表。你可以把你的原始源代码文件放在这里，Nikola将为这个目录的每个代码文件创建一个目录页和语法高亮的HTML文件。
<em>Posts</em> 是Nikola最重要的目录。该目录将存放您选定的标记语言的文章文件。
最后一个目录是 <em>stories</em> ，它包含了所有的将要显示的“静态”页面（不是贴子页面）。像 <em>关于</em> 或者 <em>联系我们</em> 页面放在这里将感觉非常好。</p>
<p>但在明白Nikola如何处理这些目录之前，我们先看一下配置文件...它控制你的整个Nikola站点。</p>
<h3>创建基本配置</h3>
<p>就像我们上面看到的，基本的站点初始化给你一个内容充实的 <em>conf.py</em> 文件。
为了学习......我建议你备份conf.py文件和建立一个空的文件。</p>
<p>打开你最喜欢的编辑器，让我们开始建立一个新的Nikola站点配置文件。
由于Nikola是一个Python的应用程序，也是用Python语言编写的配置文件。
因此，我们必须做的第一件事是加载一些Python模块，所以Nikola可以成功地解析该文件：</p>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre>


<p>接下来我们就可以设置我们的网站的一些基本信息和变量，将应用到我们的模板中：</p>
<pre class="code literal-block"><span class="n">BLOG_AUTHOR</span> <span class="o">=</span> <span class="s">"Tim van der Linden"</span>
<span class="n">BLOG_TITLE</span> <span class="o">=</span> <span class="s">"Shisaa.jp"</span>
<span class="n">BLOG_URL</span> <span class="o">=</span> <span class="s">"http://Shisaa.jp"</span>
<span class="n">BLOG_EMAIL</span> <span class="o">=</span> <span class="s">"tim@Shisaa.jp"</span>
<span class="n">BLOG_DESCRIPTION</span> <span class="o">=</span> <span class="s">"A blog about Programming, Japan and Photography"</span>
</pre>


<p>够简单了吧？现在来保存这个文件。它的名字 <em>必须</em> 是conf.py和 <em>必须</em> 保存在你的Nikola站点的根目录下。</p>
<p>接下来要做的事情是告诉Nikola我们想处理的不同内容。因为Nikola是一个博客引擎的心脏，我们会从那里开始。</p>
<p>静态网站生成器遵循大致相同的原则：你用标记语言写你的文章或网页，定义这些标记文件的模板，并把一些静态文件，如CSS或JavaScript，然后你让生成器做所有逻辑和输出目录以HTML格式呈现出来。所以我们首先定义一个地方放我们的博客标记文章文件。在Nikola，默认是 <em>post</em> 目录。实际上，你可以把它放在任何你喜欢的地方，只要你告诉Nikola哪里可以找到它。</p>
<p>所以接下来，我们要进入我们的配置文件建立一个哈希表：</p>
<pre class="code literal-block"><span class="n">post_pages</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s">"posts/*.md"</span><span class="p">,</span> <span class="s">"posts"</span><span class="p">,</span> <span class="s">"post.tmpl"</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
<span class="p">)</span>
</pre>


<p>这个哈希表称为 <em>post_pages</em> ，并遵循一定的语法。首先，在我们定义目录下，我们会把我们的文章（基于 <em>md</em> 语法的文件）放在那里。然后我们定义内容的类型，Nikola会在那里找到它，（您还可以定义页面在这里，稍后将会看到），第三项是渲染时使用的模板文件。最后一项是一个布尔值，你可以设置告诉Nikola是否在网站RSS中包括这些文件。</p>
<p>接下来Nikola需要知道用哪种语言写的静态文件。你可以简单地写 <em>HTML</em> 或使用其它Nikola支持的标记语言，如 <em>Markdown</em> 或 <em>reStructuredText</em> 。为此，我们定义另一个称为<em>post_compilers</em>哈希表：</p>
<pre class="code literal-block"><span class="n">post_compilers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"markdown"</span><span class="p">:</span> <span class="p">(</span><span class="s">'.md'</span><span class="p">,</span> <span class="s">'.mdown'</span><span class="p">,</span> <span class="s">'.markdown'</span><span class="p">),</span>
<span class="p">}</span>
</pre>


<p>我的情况只用Markdown。所以这是我唯一的定义。您可以使用更多的语言，在这基础上扩展Nikola并定义使用正确的编译器转换成HTML。</p>
<p>相当的好玩，是不是？</p>
<h3>写你的文章</h3>
<p>Nikola有一个命令来启动一个新的文章：</p>
<pre class="code literal-block"><span class="nv">$ </span>nikola new_post -f markdown
</pre>


<p>它会问你一些必要的元数据并加到文本本身。注意 <em>-f</em> 标志，如果你使用多种标记语言，你将要指定你想要的语言来编写的新的文章。</p>
<p>用不同的方式，对我来说更方便，手动创建你的文章文件，并将其保存在你的文章目录下。</p>
<p>要手动开始一篇文章，只需打开你喜欢的编辑器和文章目录下保存该文件用得体的名字。
对于这个文件我们必须做的第一件事就是宣告一些元数据，Nikola将使用这些数据生成HTML页面，内部链接和标签。
每行只包含一个元数据，使用的语法是，以两个点和空格开始。默认的文章或页面将像这样：</p>
<pre class="code literal-block"><span class="cp">.. title: Your blog post title</span>
<span class="cp">.. slug: any-unique-slug-you-like</span>
<span class="cp">.. date: 2013/02/27 18:52:05</span>
<span class="cp">.. tags: web, blog</span>
</pre>


<p>配置之后你可以开始写你心爱的文章，用你标记的语言格式，就是定义在 <em>conf.py</em> 的标语语言。</p>
<h3>第一次编译</h3>
<p>好，虽然对于这个过程有点早，但我们已经可以做一个测试版本看到目前为止的效果，明确我们已经做了什么。</p>
<p>只要运行下面的命令并观察输出结果：</p>
<pre class="code literal-block"><span class="nv">$ </span>nikola build
</pre>


<p>Nikola将创建一个名为"output"的目录，整个网站的结构将放在那里。
关于构建过程中的一个不错的细节，就是它仅仅编译修改过的文件和依赖文件。
也就是说你更新的博客文章，只有博客的文章将被重新渲染，包括文件中链接指向到该文章....仅此而已。
这意味着，你最初的构建可能需要几秒钟，但在那之后就更快了！</p>
<p>如果一切顺利的话，你现在可以查验实际的编译结果。
怎么样做到呢，你可以设置一个Web服务器并指向 "output" 目录...或者你可以使用Nikola来构建服务器。
在同一个站点的根目录下，启动Nikola来建立服务器：</p>
<pre class="code literal-block"><span class="nv">$ </span>nikola serve
</pre>


<p>看吧...你在浏览器上输出“http://localhost:8000”（端口配置在你网站的config.py文件中），看到是多么美丽的画面！
我通常会打开一个新的终端，并运行Nikola​​服务器，只有这样，我在主终端可以随时用 "nikola build" 编译文章。
请记住，对于每一个新的终端，开始之前要再次设置你的虚拟环境源。</p>
<p>“但是网站看起来像Nikola的首页！”，你会说。这是对的。
你看到的是Nikola自带的默认主题。
我们希望网站完全是我们自己的，所以这也意味着要自定义生成主题。</p>
<p>所以，你猜怎么着...接下来： <em>创建你的主题</em> ！</p>
<h3>创建主题样式</h3>
<p>正如我们上面看到的，你可以告诉Nikola使用已经定义在 <em>post_pages</em> 哈希表中的任何一个模板文件（模板文本用 <em>tmpl</em> 后缀名）。
但这些模板文件，位于何处？嗯......在一个主题中。</p>
<p>Nikola始终搜索 <em>themes</em> 目录中的主题并加载你定义在 <em>conf.py</em> 中的主题：</p>
<pre class="code literal-block"><span class="n">THEME</span> <span class="o">=</span> <span class="s">'shisaa'</span>
</pre>


<p>现在Nikola将在 <em>themes</em> 目录下搜索名为 <em>shisaa</em> 的目录。</p>
<p>“等一下！”，你迅速发问，“我之前没有配置一个主题，但仍然有默认的...是什么魔力发生这一切？”</p>
<p>嗯，很高兴你发问。</p>
<p>当你安装Nikola之后，Nikola已经附带了几个主题。</p>
<p>这些的主题存放在Nikola的源码中。得到它们，你只需打开 <em>lib</em> 目录在你的Python安装目录下。
请记住，如果你通过Virtualenv安装的Python，那么你需要打开这个环境的 <em>lib</em> 目录。</p>
<p>在你的 <em>lib</em> 中你将会看到你的Python版本，打开之后你会发现有个目录叫 <em>site-packages</em>。
在那里你会看到Nikola目录，在那里有名叫 <em>data</em> 目录。
在 <em>data</em> 目录下有一个名叫 <em>themes</em> 的目录，里面包含了所有的基本主题。
如果你没有定义任何主题在你的conf.py中，它会使用名为 <em>default</em> 主题。</p>
<p>呵呵，谜底揭晓！</p>
<p>也许你会发现：在主题中有一个叫 <em>Orphan</em> 的主题。这实际上是一个剥离下来的主题，你可以使用它。
所以如果你厌倦去阅读代码，只需复制到你的主题目录，重新命名，并开始调整主题。
或者只是继续阅读代码...跟我一样会找到更多的乐趣！</p>
<p>你还在吗？好！让我们继续主题化！</p>
<p>Nikola支持 <em>Mako</em> 或者 <em>Jinja</em> 主题引擎，我选择 <em>Mako</em> 生成shisaa主题。
Mako只需要几个目录在你的主题目录里面，在那里你可以存储不同类型的文件。你基本上需要三个目录：</p>
<ul>
<li>assets</li>
<li>templates</li>
<li>messages</li>
</ul>
<p><em>assets</em> 目录将包含所有的静态文件，如CSS, Javascript, images，...都是针对你的主题的。
<em>Templates</em> 将存放真正的 <em>.tmpl</em> 文件。
最后 <em>messages</em> 目录包含Nokia支持的多语言文件。现在，我们将只专注于英语。</p>
<p>让我们先从最精彩的 <em>templates</em> 目录开始。</p>
<p>Nikola使用一组硬编码文件名的模板文件，他将会被找到。
在Nikola的<a href="http://getnikola.com/theming.html" title="基本主题化的文档">基本主题文件</a>是：</p>
<ul>
<li>base.tmpl</li>
<li>index.tmpl</li>
<li>post.tmpl</li>
<li>listing.tmpl</li>
<li>list.tmpl</li>
<li>list_post.tmpl</li>
<li>tags.tmpl</li>
</ul>
<p>还有少数其它几个（即 <em>gallery.tmpl</em>, <em>story.tmpl</em> ），但这个更进一步的特性。</p>
<p>但在开始编译这些文件之前，让我们对Mako有一个大概的了解：</p>
<p>Mako是用Python编写的模板引擎来<em>运行</em>Python。它与Python语言有非常密切的关系。一个Mako模板文件可以很容易从其它Mako模板文件继承，使您能保持模板的逻辑整洁。你可以继承一个文件，使用下面的语法：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
</pre>


<p>接下来你将使用继承的模板块代码，你使用你的主模板：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"footer"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;div id="footer"&gt;</span>
<span class="x">        &lt;p&gt;This is a footer, just static html!&lt;/p&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>现在在你继承的模板文件中你可以调用该功能块，像这样：</p>
<pre class="code literal-block"><span class="cp">${</span><span class="n">footer</span><span class="p">()</span><span class="cp">}</span><span class="x"></span>
</pre>


<p>除了继承，你可以使用任何Python代码嵌入到你的模板文件中。
要使用Python代码，以 <em>&lt;%</em> 开始和 <em>%&gt;</em> 结束你的代码块来完成：</p>
<pre class="code literal-block"><span class="cp">&lt;%!</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s">"foobar"</span>
<span class="cp">%&gt;</span><span class="x"></span>
</pre>


<p>当然，你也可以使用控制结构构建循环或进行简单的判断，甚至捕获异常，...
我建议你​​去阅读<a href="http://docs.makotemplates.org/en/latest/" title="Mako的文档">Mako的文档</a>，你将会发现这是个非常强大的模板语言。
现在，让我们动手创建一个主题采用Mako的语法！</p>
<p>如果你还没有这样做，在你的Nikola项目的根目录下创建你的主题目录，然后在 <em>conf.py</em> 中宣告你的主题。</p>
<p>主题需求的第一件事是翻译的语言信息，即使你的网站将是只用一种语言，你仍然需要设置正确的翻译字符串。
该消息翻译存储你的主题中称为 "messages" 的目录下。所以打开你的主题并创建该目录。</p>
<p>你想支持的每种翻译语言采用的语法如下：<strong>语言代码</strong><em>_messages.py</em>。
例如默认的英文翻译，创建一个文件名为 <em>en_messages.py</em>。
此文件 <em>必须</em> 有导入模块和叫 <em>MESSAGES</em> 的字典包含如下固定数量的项：</p>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="n">MESSAGES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"LANGUAGE"</span><span class="p">:</span> <span class="s">"English"</span><span class="p">,</span>
    <span class="s">"Posts for year </span><span class="si">%s</span><span class="s">"</span><span class="p">:</span> <span class="s">"Posts for year </span><span class="si">%s</span><span class="s">"</span><span class="p">,</span>
    <span class="s">"Archive"</span><span class="p">:</span> <span class="s">"Archive"</span><span class="p">,</span>
    <span class="s">"Posts about </span><span class="si">%s</span><span class="s">"</span><span class="p">:</span> <span class="s">"Posts about </span><span class="si">%s</span><span class="s">"</span><span class="p">,</span>
    <span class="s">"Tags"</span><span class="p">:</span> <span class="s">"Tags"</span><span class="p">,</span>
    <span class="s">"Also available in"</span><span class="p">:</span> <span class="s">"Also available in"</span><span class="p">,</span>
    <span class="s">"More posts about"</span><span class="p">:</span> <span class="s">"More posts about"</span><span class="p">,</span>
    <span class="s">"Posted"</span><span class="p">:</span> <span class="s">"Posted"</span><span class="p">,</span>
    <span class="s">"Original site"</span><span class="p">:</span> <span class="s">"Original site"</span><span class="p">,</span>
    <span class="s">"Read in English"</span><span class="p">:</span> <span class="s">"Read in English"</span><span class="p">,</span>
    <span class="s">"Newer posts"</span><span class="p">:</span> <span class="s">"Newer posts"</span><span class="p">,</span>
    <span class="s">"Older posts"</span><span class="p">:</span> <span class="s">"Older posts"</span><span class="p">,</span>
    <span class="s">"Previous post"</span><span class="p">:</span> <span class="s">"Previous post"</span><span class="p">,</span>
    <span class="s">"Next post"</span><span class="p">:</span> <span class="s">"Next post"</span><span class="p">,</span>
    <span class="s">"old posts page </span><span class="si">%d</span><span class="s">"</span><span class="p">:</span> <span class="s">"old posts page </span><span class="si">%d</span><span class="s">"</span><span class="p">,</span>
    <span class="s">"Read more"</span><span class="p">:</span> <span class="s">"Read more"</span><span class="p">,</span>
    <span class="s">"Source"</span><span class="p">:</span> <span class="s">"Source"</span><span class="p">,</span>
<span class="p">}</span>
</pre>


<p>即使你不使用这些翻译，你仍然需要保留着。</p>
<p>接下来我们来构建我们的实际呈现出最终的HTML模板文件。</p>
<p><strong>警告：每个TMPL文件的改变更适合我的Shisaa.jp的需要。我不作评论或多种语言功能。如果你想看到原来的主题代码，请仔细阅读 Orphan 主题的 tmpl 文件！</strong></p>
<p>因为我们需要相当多的HTML片段和很多Mako的结构在我们的模板文件中，可以想象是非常不可读的。
为了防止这种情况，有是一个很好的做法，利用Mako的<em>定义块</em>。
正如我们先前看到的，Mako让您能够定义的“代码块”，你以后可以很简单地调用函数块。</p>
<p>你问我：“我要怎么才能做到呢？”。</p>
<p>好吧，让我们按所说的进行练习，在你的<em>templates</em>目录下创建两个文件。
一个称为 <em>base.tmpl</em> ，另一个称为 <em>base_helper.tmpl</em>。
<em>base.tmpl</em> 是主模板文件，也就是HTML标记的框架。这里定义了 <em>head</em>, <em>html</em> 和 <em>body</em> 标记。
<em>base_helper.tmpl</em> ，Nikola不关心这个文件，但你可以用它来保存可重用的定义块，这样你可以保持<em>base.tmpl</em>的简洁。
其实，你可以调用户任何称为"helper"的文件（或只要你高兴，可以创造尽可能多的helper文件），但清晰地命名 <em>base_helper.tmpl</em> 是这样一个不错的选择。</p>
<p>现在，让我们使用这些文件，怎么样？</p>
<p>首先，要在文件 <em>base.tmpl</em> 能够使用自定义的块中声明，你首先要告诉 <em>base.tmpl</em> 文件。
你可以简单地导入定义块使用Mako的“命名空间”属性：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">namespace</span> <span class="na">file=</span><span class="s">"base_helper.tmpl import="</span><span class="err">*"</span><span class="cp">/&gt;</span><span class="x"></span>
</pre>


<p>这一行简单地告诉Mako从 <em>base_helper.tmpl</em> 文件导入所有的定义块。
如果你只想要导入helper文件中的部分块，只需删除通配符(*)，将名字组成用逗号分隔的字符串放在 <em>import=""</em> 属性中。
将这一行放在 <em>base.tmpl</em> 文件的顶部。</p>
<p>在开始之前，让我们在 <em>base.tmpl</em> 中创建框架代码。
shisaa框架看起来有点像这样：</p>
<pre class="code literal-block"><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"${lang}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre>


<p>但是这虽然美丽，但只能显示为空白页。我们需要显示实际内容。</p>
<p>首先，<em>head</em>，你不觉得它看起来很空吗？没有标题，没有css，没有favicon，...
我们可以直接把它放在 <em>base.tmpl</em> 文件中，但我们希望它尽可能整洁。
所以最好是在 <em>base_helpers.tmpl</em> 文件中定义，让我们来定义header块：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_head()"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;meta charset="utf-8"&gt;</span>
<span class="x">    &lt;meta name="title" content="</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x"> | </span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">" &gt;</span>
<span class="x">    &lt;meta name="description" content="</span><span class="cp">${</span><span class="n">description</span><span class="cp">}</span><span class="x">" &gt;</span>
<span class="x">    &lt;meta name="author" content="</span><span class="cp">${</span><span class="n">blog_author</span><span class="cp">}</span><span class="x">"&gt;</span>
<span class="x">    &lt;title&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x"> | </span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">&lt;/title&gt;</span>
<span class="x">    &lt;link type="image/x-icon" href="/assets/img/favicon.ico" rel="icon" /&gt;</span>
<span class="x">    &lt;link type="image/x-icon" href="/assets/img/favicon.ico" rel="shortcut icon" /&gt;</span>
<span class="x">    &lt;link href="/assets/css/reset.css" rel="stylesheet" type="text/css"/&gt;</span>
<span class="x">    &lt;link href="/assets/css/theme.css" rel="stylesheet" type="text/css"/&gt;</span>
<span class="x">    &lt;!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --&gt;</span>
<span class="x">    &lt;!--[if lt IE 9]&gt;</span>
<span class="x">    &lt;script src="/assets/js/html5shiv.js" type="text/javascript"&gt;&lt;/script&gt;</span>
<span class="x">    &lt;script src="/assets/js/html5shiv-print.js" type="text/javascript"&gt;&lt;/script&gt;</span>
<span class="x">    &lt;![endif]--&gt;</span>
    <span class="cp">%</span><span class="k">if</span> <span class="n">rss_link</span><span class="p">:</span><span class="x"></span>
<span class="x">        </span><span class="cp">${</span><span class="n">rss_link</span><span class="cp">}</span>
    <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>这看起来有点像你所期望的 <em>head</em> 标记，对不对？</p>
<p>正如你看到，我们可以在主题里使用存储在<em>conf.py</em>的变量。
要使用一个变量，你只需用 <em>${}</em> 语法。也就是你看到 <em>${lang}</em> 变量设置在当前的HTML文件<em>base.tmpl</em>中。
注意有一些变量不在配置文件里定义（如 <em>title</em> ），而是从你的文章或网页的标记文件的元数据里面得到。</p>
<p>所以现在我们有一个整洁的header，但如何放在<em>base.tmpl</em>的正确位置？
简单地通过使用与呈现变量的相同语法，唯一的区别是，应该被称为定义块——他们的功能，而不是简单的变量。
这意味着需要调用，用 <em>${foo()}</em> 而不是 <em>${foo}</em>。
所以调用这个定义块在<em>头</em>部：</p>
<pre class="code literal-block"><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"${lang}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        ${html_head()}
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre>


<p>现在，关于 <em>body</em> 部分？这里需要显示我们的文章或页面等的实际内容..
我们总是希望在屏幕上显示一个固定的标题，所以让我们添加一个很好语义的 <em>h1</em> 来包含标题，并使其可随时点击回到主页：</p>
<pre class="code literal-block"><span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">"blog-title"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"${abs_link('/')}"</span> <span class="na">title=</span><span class="s">"${blog_title}"</span><span class="nt">&gt;</span>${blog_title}<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/h1&gt;</span>
</pre>


<p>下一步，我们需要一个占位符，这样Nikola就知道在哪里呈现所有的内容在我们架构中。
在这里我们可以引进Mako的 <em>继承</em> 概念。</p>
<p>我们所要做的唯一事情是定义一个 <em>block</em> 让所有其他的模板文件来填充。
你的页面标题下面，加入下面的内容：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>所有其他模板将参考此标记，并在那里将内容呈现出来。
这些模板将需要继承自<em>base.tmpl</em>：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
</pre>


<p>他们将包含相同名称的块，具体的模板标记如下：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    ...</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>是不很简单？</p>
<p>如果你还不完全明白，不用担心，我们还会回来，首先让我们完成我们的<em>base.tmpl</em>。</p>
<p>我还需要呈现页脚的内容：</p>
<pre class="code literal-block"><span class="cp">${</span><span class="n">content_footer</span><span class="cp">}</span><span class="x"></span>
</pre>


<p>但 <em>content_footer</em> 这个变量从哪里来的呢？在conf.py中定义：</p>
<pre class="code literal-block"><span class="n">CONTENT_FOOTER</span> <span class="o">=</span> <span class="s">'Contents &amp;copy; {date} &lt;a href="mailto:{email}"&gt;{author}&lt;/a&gt; - Powered by &lt;a href="http://getnikola.com"&gt;Nikola&lt;/a&gt;'</span>
</pre>


<p>在你的配置文件中找到这行，并调整成为你的要求！</p>
<p>现在唯一缺少的是一个菜单。</p>
<p>你会注意到shisaa有一个侧边风格的菜单。
这个菜单生成的链接是在conf.py中的<em>SIDEBAR_LINKS</em>字典中定义：</p>
<pre class="code literal-block"><span class="n">SIDEBAR_LINKS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">DEFAULT_LANG</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="s">'Home'</span><span class="p">),</span>
        <span class="p">(</span><span class="s">'/archive.html'</span><span class="p">,</span> <span class="s">'Blog),</span>
        <span class="p">(</span><span class="s">'/stories/about.html'</span><span class="p">,</span> <span class="s">'About),</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre>


<p>你会发现菜单中也多语种，但因为我只使用一种语言，只宣告 <em>DEFAULT_LANG</em> 字典就足够。
在字典中，你首先宣告链接路径，然后是你想显示的菜单名称。
这个标记定义在 <em>base_helper.tmpl</em> 文件中：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_sidebar_links()"</span><span class="cp">&gt;</span>
    <span class="cp">%</span><span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">sidebar_links</span><span class="p">[</span><span class="n">lang</span><span class="p">]:</span><span class="x"></span>
        <span class="cp">%</span> <span class="k">if</span> <span class="n">rel_link</span><span class="p">(</span><span class="n">permalink</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span> <span class="o">==</span> <span class="s">"#"</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="active"&gt;&lt;a href="</span><span class="cp">${</span><span class="n">url</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k">else</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li&gt;&lt;a href="</span><span class="cp">${</span><span class="n">url</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
    <span class="cp">%</span><span class="k">endfor</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>“这是怎么得来的呢？”，你可能会感到奇怪。</p>
<p>正如我们已经看到我们的小Mako的介绍，你有可以在模板里使用内部控制结构和循环。
上面我们看到这两者的定义块。</p>
<p>首先，我们在 <em>SIDEBAR_LINKS</em> 字典的当前（或默认）语言循环。
在字典的每一项页面链接如果是指向当前页，那么就加上 "<em>active</em>" 样式。
这样我们的工具栏菜单就被渲染了。</p>
<p>当我们把所有这些内容放在一起，shisaa的<em>base.tmpl</em>看起来像这样子：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">namespace</span> <span class="na">file=</span><span class="s">"base_helper.tmpl"</span> <span class="na">import=</span><span class="s">"*"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang="</span><span class="cp">${</span><span class="n">lang</span><span class="cp">}</span><span class="x">"&gt;</span>
<span class="x">    &lt;head&gt;</span>
<span class="x">        </span><span class="cp">${</span><span class="n">html_head</span><span class="p">()</span><span class="cp">}</span><span class="x"></span>
<span class="x">    &lt;/head&gt;</span>
<span class="x">    &lt;body&gt;</span>
<span class="x">        &lt;h1 id="blog-title"&gt;</span>
<span class="x">            &lt;a href="</span><span class="cp">${</span><span class="n">abs_link</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span><span class="cp">}</span><span class="x">" title="</span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
<span class="x">        &lt;/h1&gt;</span>
<span class="x">        &lt;ul id="sidebar"&gt;</span>
<span class="x">            &lt;li&gt;</span>
<span class="x">                </span><span class="cp">${</span><span class="n">html_sidebar_links</span><span class="p">()</span><span class="cp">}</span><span class="x"></span>
<span class="x">            &lt;li&gt;</span>
<span class="x">        &lt;/ul&gt;</span>
<span class="x">        &lt;div id="content"&gt;</span>
<span class="x">            </span><span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div id="footer"&gt;</span><span class="cp">${</span><span class="n">content_footer</span><span class="cp">}</span><span class="x">&lt;/div&gt;</span>
<span class="x">    &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre>


<p><em>base_helper.tmpl</em> 看起来像这样子：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_head()"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;meta charset="utf-8"&gt;</span>
<span class="x">    &lt;meta name="title" content="</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x"> | </span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">" &gt;</span>
<span class="x">    &lt;meta name="description" content="</span><span class="cp">${</span><span class="n">description</span><span class="cp">}</span><span class="x">" &gt;</span>
<span class="x">    &lt;meta name="author" content="</span><span class="cp">${</span><span class="n">blog_author</span><span class="cp">}</span><span class="x">"&gt;</span>
<span class="x">    &lt;title&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x"> | </span><span class="cp">${</span><span class="n">blog_title</span><span class="cp">}</span><span class="x">&lt;/title&gt;</span>
<span class="x">    &lt;link type="image/x-icon" href="/assets/img/favicon.ico" rel="icon" /&gt;</span>
<span class="x">    &lt;link type="image/x-icon" href="/assets/img/favicon.ico" rel="shortcut icon" /&gt;</span>
<span class="x">    &lt;link href="/assets/css/reset.css" rel="stylesheet" type="text/css"/&gt;</span>
<span class="x">    &lt;link href="/assets/css/theme.css" rel="stylesheet" type="text/css"/&gt;</span>
<span class="x">    &lt;!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --&gt;</span>
<span class="x">    &lt;!--[if lt IE 9]&gt;</span>
<span class="x">    &lt;script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"&gt;&lt;/script&gt;</span>
<span class="x">    &lt;![endif]--&gt;</span>
    <span class="cp">%</span><span class="k">if</span> <span class="n">rss_link</span><span class="p">:</span><span class="x"></span>
<span class="x">        </span><span class="cp">${</span><span class="n">rss_link</span><span class="cp">}</span>
    <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>

<span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_sidebar_links()"</span><span class="cp">&gt;</span>
    <span class="cp">%</span><span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">sidebar_links</span><span class="p">[</span><span class="n">lang</span><span class="p">]:</span><span class="x"></span>
        <span class="cp">%</span> <span class="k">if</span> <span class="n">rel_link</span><span class="p">(</span><span class="n">permalink</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span> <span class="o">==</span> <span class="s">"#"</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="active"&gt;&lt;a href="</span><span class="cp">${</span><span class="n">url</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k">else</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li&gt;&lt;a href="</span><span class="cp">${</span><span class="n">url</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
    <span class="cp">%</span><span class="k">endfor</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>恭喜你，我们已经设置了我们模板的主框架！</p>
<p>接下来，我们来看看将要呈现<em>内容</em>的其它部分。
在我们模板探索的开始，我们看到了Nikola成功建立你的网站最少要包含的模板文件列表。
我们只是完成<em>base.tmpl</em>，还有哪些呢？</p>
<ul>
<li><s>base.tmpl<s></s></s></li>
<li>index.tmpl</li>
<li>post.tmpl</li>
<li>listing.tmpl</li>
<li>list.tmpl</li>
<li>list_post.tmpl</li>
<li>tags.tmpl</li>
</ul>
<p>文件 <em>index.tmpl</em> 会呈现出相应的 <em>index.html</em> 的内容。
在大多数博客的首页包含最新的几篇文章，或者只包含最新的一个帖子，通过下一贴的方式显示旧的帖子。
我选择了后者，滚动20页长的索引页看起来不顺眼。</p>
<p>所以我的 <em>index.tmpl</em>：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">namespace</span> <span class="na">name=</span><span class="s">"helper"</span> <span class="na">file=</span><span class="s">"index_helper.tmpl"</span> <span class="na">import=</span><span class="s">"*"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span>
    <span class="cp">%</span><span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">posts</span><span class="p">:</span><span class="x"></span>
        <span class="cp">%</span><span class="k">if</span> <span class="p">(</span><span class="n">loop</span><span class="o">.</span><span class="n">first</span><span class="p">):</span><span class="x"></span>
<span class="x">            &lt;div class="index-post"&gt;</span>
<span class="x">                &lt;h2&gt;</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">&lt;/h2&gt;</span>
<span class="x">                &lt;p class="post-date"&gt;</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span><span class="cp">}</span><span class="x"> - &lt;/p&gt;</span>
<span class="x">                </span><span class="cp">${</span><span class="n">helper</span><span class="o">.</span><span class="n">html_tags</span><span class="p">(</span><span class="n">post</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">                &lt;div class="index-post-text"&gt;</span>
<span class="x">                    </span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">                </span><span class="cp">${</span><span class="n">helper</span><span class="o">.</span><span class="n">html_pager</span><span class="p">(</span><span class="n">post</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">            &lt;/div&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
    <span class="cp">%</span><span class="k">endfor</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>我们在顶部我们继承了base.tmpl文件。接下来我们加载了辅助文件，这个辅助文件将包含标签和页面渲染的逻辑。
最后我们呈现出我们的基本标记。因为我只想显示第一篇文章（最新文章），我用Mako的<a href="http://docs.makotemplates.org/en/latest/runtime.html" title="Mako的循环逻辑环的更多内容">循环逻辑</a>，但只显示循环的第一次迭代。</p>
<p><em>index_helper.tmpl</em> 看起来像这样子：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_tags(post)"</span><span class="cp">&gt;</span>
    <span class="cp">%</span> <span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;ul class="tags"&gt;</span>
            <span class="cp">%</span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">post</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span><span class="x"></span>
<span class="x">                &lt;li class="tag"&gt;&lt;a href="</span><span class="cp">${</span><span class="n">_link</span><span class="p">(</span><span class="s">'tag'</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">tag</span><span class="cp">}</span><span class="x">&lt;/a&gt;&lt;/li&gt;          </span>
            <span class="cp">%</span><span class="k">endfor</span><span class="x"></span>
<span class="x">        &lt;/ul&gt;</span>
    <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>

<span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_pager(post)"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;ul class="pager"&gt;</span>
        <span class="cp">%</span><span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">prev_post</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="previous"&gt;</span>
<span class="x">                &lt;a href="</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">prev_post</span><span class="o">.</span><span class="n">permalink</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;&amp;larr; </span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Previous post"</span><span class="p">]</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
<span class="x">            &lt;/li&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
        <span class="cp">%</span><span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">next_post</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="next"&gt;</span>
<span class="x">                &lt;a href="</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">next_post</span><span class="o">.</span><span class="n">permalink</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Next post"</span><span class="p">]</span><span class="cp">}</span><span class="x"> &amp;rarr;&lt;/a&gt;</span>
<span class="x">            &lt;/li&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
<span class="x">    &lt;/ul&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>很好，所有的索引中多了一个完成的项：</p>
<ul>
<li><s>base.tmpl</s></li>
<li><s>index.tmpl</s></li>
<li>post.tmpl</li>
<li>listing.tmpl</li>
<li>list.tmpl</li>
<li>list_post.tmpl</li>
<li>tags.tmpl</li>
</ul>
<p>下一逻辑步骤在我们文章本身，专用的单个帖子页。这由 <em>post.tmpl</em> 处理。
对于这里的每一个文件我们可以看到都是采用相同的模式：他们都是从 <em>base.tmpl</em> 继承 <em>content</em> 块。
所以，我们只看一部分。</p>
<p>下面是我渲染文章的模板：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">namespace</span> <span class="na">name=</span><span class="s">"helper"</span> <span class="na">file=</span><span class="s">"post_helper.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;div class="postbox"&gt;</span>
<span class="x">        </span><span class="cp">${</span><span class="n">helper</span><span class="o">.</span><span class="n">html_title</span><span class="p">()</span><span class="cp">}</span><span class="x"></span>
<span class="x">        &lt;small&gt;</span>
<span class="x">            </span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Posted"</span><span class="p">]</span><span class="cp">}</span><span class="x">: </span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">            </span><span class="cp">${</span><span class="n">helper</span><span class="o">.</span><span class="n">html_tags</span><span class="p">(</span><span class="n">post</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">        &lt;/small&gt;</span>
<span class="x">        </span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">        </span><span class="cp">${</span><span class="n">helper</span><span class="o">.</span><span class="n">html_pager</span><span class="p">(</span><span class="n">post</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">    &lt;/div&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>还有helper文件：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_title()"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;h1&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x">&lt;/h1&gt;</span>
    <span class="cp">%</span> <span class="k">if</span> <span class="n">link</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;p&gt;&lt;a href='</span><span class="cp">${</span><span class="n">link</span><span class="cp">}</span><span class="x">'&gt;</span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Original site"</span><span class="p">]</span><span class="cp">}</span><span class="x">&lt;/a&gt;&lt;/p&gt;</span>
    <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>

<span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_tags(post)"</span><span class="cp">&gt;</span>
    <span class="cp">%</span><span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span><span class="x"></span>
<span class="x">        </span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"More posts about"</span><span class="p">]</span><span class="cp">}</span>
        <span class="cp">%</span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">post</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;a class="tag" href="</span><span class="cp">${</span><span class="n">_link</span><span class="p">(</span><span class="s">'tag'</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;&lt;span class="badge badge-info"&gt;</span><span class="cp">${</span><span class="n">tag</span><span class="cp">}</span><span class="x">&lt;/span&gt;&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k">endfor</span><span class="x"></span>
    <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>

<span class="cp">&lt;%</span><span class="nb">def</span> <span class="na">name=</span><span class="s">"html_pager(post)"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;ul class="pager"&gt;</span>
        <span class="cp">%</span><span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">prev_post</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="previous"&gt;</span>
<span class="x">                &lt;a href="</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">prev_post</span><span class="o">.</span><span class="n">permalink</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;&amp;larr; </span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Previous post"</span><span class="p">]</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
<span class="x">            &lt;/li&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
        <span class="cp">%</span><span class="k">if</span> <span class="n">post</span><span class="o">.</span><span class="n">next_post</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li class="next"&gt;</span>
<span class="x">                &lt;a href="</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">next_post</span><span class="o">.</span><span class="n">permalink</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">messages</span><span class="p">[</span><span class="n">lang</span><span class="p">][</span><span class="s">"Next post"</span><span class="p">]</span><span class="cp">}</span><span class="x"> &amp;rarr;&lt;/a&gt;</span>
<span class="x">            &lt;/li&gt;</span>
        <span class="cp">%</span><span class="k">endif</span><span class="x"></span>
<span class="x">    &lt;/ul&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">def</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>现在，这一切看起来都很简单。我们在helper文件了定义三个块，其中最后两个我们同时在 <em>index_helper.tmpl</em> 中使用：</p>
<ul>
<li>第一块渲染标题。</li>
<li>第二块渲染标签并链接到一个页面，这个页面列出包含该标签的所有文章。</li>
<li>最后是一个导航可以显示新文章或者老文章。</li>
</ul>
<p>很简单，对不对？
再划掉一个：</p>
<ul>
<li><s>base.tmpl</s></li>
<li><s>index.tmpl</s></li>
<li>
<s>post.tmpl</s> </li>
<li>listing.tmpl</li>
<li>list.tmpl</li>
<li>list_post.tmpl</li>
<li>tags.tmpl</li>
</ul>
<p>下一个是渲染代码清单的功能，就是我们之前看到的文章，看起来像这样：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;ul class="breadcrumb"&gt;</span>
        <span class="cp">%</span> <span class="k">for</span> <span class="n">link</span><span class="p">,</span> <span class="n">crumb</span> <span class="ow">in</span> <span class="n">crumbs</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li&gt;&lt;a href="</span><span class="cp">${</span><span class="n">link</span><span class="cp">}</span><span class="x">"&gt;/ </span><span class="cp">${</span><span class="n">crumb</span><span class="cp">}</span><span class="x">&lt;/a&gt;&lt;/li&gt;</span>
        <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">    &lt;/ul&gt;</span>
<span class="x">    </span><span class="cp">${</span><span class="n">code</span><span class="cp">}</span><span class="x"></span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>We first render out a breadcrumb that resembles the path of the file in a hierarchical directory structure and after that we simply render the code. That's it!
我们先呈现出类似于面包屑的分层目录结构的文件，然后我们只是简单的渲染它。再看看！</p>
<ul>
<li><s>base.tmpl</s></li>
<li><s>index.tmpl</s></li>
<li><s>post.tmpl</s></li>
<li><s>listing.tmpl</s></li>
<li>list.tmpl</li>
<li>list_post.tmpl</li>
<li>tags.tmpl</li>
</ul>
<p>最后我们只剩下三个文件， <em>list.tmpl</em>, <em>list_post.tmpl</em> 和 <em>tags.tmpl</em> ，使用几乎相同的模板。
它们之间的主要区别是他们有自己的数据。
<em>list.tmpl</em> 有 <em>items</em> 词典提供一般的链接， <em>list_post.tmpl</em> 得到 <em>posts</em> 目录包含所有的文章， <em>tags.tmpl</em> 得到一字典包含所有标签信息。</p>
<p><em>list_post.tmpl</em> 用来按年份来显示文章的列表（当用存档显示的方式浏览）。该模板看起来像这样：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;!--Body content--&gt;</span>
<span class="x">    &lt;div class="postbox"&gt;</span>
<span class="x">        &lt;h1&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x">&lt;/h1&gt;</span>
<span class="x">        &lt;ul class="unstyled"&gt;</span>
            <span class="cp">%</span> <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">posts</span><span class="p">:</span><span class="x"></span>
<span class="x">                &lt;li&gt;&lt;a href="</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">permalink</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">"&gt;[</span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span><span class="cp">}</span><span class="x">] </span><span class="cp">${</span><span class="n">post</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
            <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">        &lt;/ul&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;!--End of body content--&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>这个模板没有必要使用helper文件，因为没有这么多的功能。它只呈现一个包含文章标题的无序列表。
当然，你可以让更多从 <em>posts</em> 中的内容在这里面渲染出来。</p>
<p>当你对比将看到 <em>list.tmpl</em> 会发现用相同的代码，只是用 <em>items</em> 代替 <em>posts</em>：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;!--Body content--&gt;</span>
<span class="x">    &lt;div class="postbox"&gt;</span>
<span class="x">        &lt;h1&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x">&lt;/h1&gt;</span>
<span class="x">        &lt;ul class="unstyled"&gt;</span>
            <span class="cp">%</span> <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span><span class="x"></span>
<span class="x">                &lt;li&gt;&lt;a href="</span><span class="cp">${</span><span class="n">link</span><span class="cp">}</span><span class="x">"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/a&gt;</span>
            <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">        &lt;/ul&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;!--End of body content--&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>下面是渲染对你有用户的不同年份列表。</p>
<p>文件 <em>tags.tmpl</em> 也是用 <em>items</em> 保存所有的信息：</p>
<pre class="code literal-block"><span class="cp">&lt;%</span><span class="nb">inherit</span> <span class="na">file=</span><span class="s">"base.tmpl"</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="cp">&lt;%</span><span class="nb">block</span> <span class="na">name=</span><span class="s">"content"</span><span class="cp">&gt;</span><span class="x"></span>
<span class="x">    &lt;div class="postbox"&gt;</span>
<span class="x">    &lt;!--Body content--&gt;</span>
<span class="x">        &lt;h1&gt;</span><span class="cp">${</span><span class="n">title</span><span class="cp">}</span><span class="x">&lt;/h1&gt;</span>
<span class="x">        &lt;ul class="unstyled"&gt;</span>
        <span class="cp">%</span> <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span><span class="x"></span>
<span class="x">            &lt;li&gt;&lt;a class="tag" href="</span><span class="cp">${</span><span class="n">link</span><span class="cp">}</span><span class="x">"&gt;&lt;span class="badge badge-info"&gt;</span><span class="cp">${</span><span class="n">text</span><span class="cp">}</span><span class="x">&lt;/span&gt;&lt;/a&gt;</span>
        <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">        &lt;/ul&gt;</span>
<span class="x">    &lt;!--End of body content--&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="cp">&lt;/%</span><span class="nb">block</span><span class="cp">&gt;</span><span class="x"></span>
</pre>


<p>呼，我们已经写了所有必要的模板文件。
这意味着现在Nikola有足够的信息来呈现出每一个独立HTML页面。</p>
<h3>测试运行</h3>
<p>那么，你准备好进入构建的第二阶段了吗？这一次有自己的主题了吗？冲啊！</p>
<pre class="code literal-block"><span class="nv">$ </span>nikola build
</pre>


<p>如果您仍然在另一个终端有Nikola服务器运行，你就可以刷新页面，这样就看到你新的模板。
当然，我们没有写任何CSS，所以一切看起来挺像<a href="https://duckduckgo.com/?q=css+naked+day" title="在 DuckDuckGo 中的 css naked day">CSS Naked Day</a>（这本身是一个很好的测试）。</p>
<p>在这篇文章的开头，我们构建了页眉和包含一些CSS文件，这些文件我已经用在Shisaa.jp中。继续修改你的主题风格并正确地链接到这些文件，并重新编译。</p>
<p>现在你有了一个可以运行的Nikola的网站了！</p>
<p>我希望我能让你的指尖在建立Nikola网站过程中充满力量。
现在可以进行更多了，我鼓励你去探索更多的功能，如画廊，多种语言，DISQUS一体化，尝试不同的标记语言，...</p>
<p>和往常一样...感谢你的阅读！</p>
<hr>
<h3>后记</h3>
<p>很开心陆续花了3天时间翻译完了这篇文章，因英文水平和表达能力有限，有翻译不对的地方或者建议欢迎联系<a href="mailto:mike.cyc@gmail.com" title="Mike's Email">Mike Chen</a>，同时也欢迎更多喜欢Nikola的Funs一同分享心得，谢谢你的阅读！</p>
</div>
            </div>
        </div>
            <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">新一篇</a>
            </li>
        </ul></nav><script>var disqus_shortname="nikolademo";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2016         <a href="mailto:539234@qq.com">七</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="assets/js/jquery.timeago.js" type="text/javascript"></script><script src="assets/js/mathjax.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
